{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/victo/OneDrive/Escritorio/TFG/TFG-C\\xF3digo/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/core\";\nimport * as i3 from \"../../services/auth.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/material/icon\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/stepper\";\nimport * as i10 from \"@angular/material/datepicker\";\nimport * as i11 from \"ngx-material-file-input\";\n\nfunction RegistroComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Datos personales\");\n  }\n}\n\nfunction RegistroComponent_ng_template_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Configuraci\\u00F3n de inicio de sesi\\u00F3n\");\n  }\n}\n\nfunction RegistroComponent_ng_template_50_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Terminar\");\n  }\n}\n\nexport class RegistroComponent {\n  constructor(_formBuilder, date, authService, router) {\n    this._formBuilder = _formBuilder;\n    this.date = date;\n    this.authService = authService;\n    this.router = router;\n    this.hide = true;\n    this.hideRepetida = true;\n    this.datosPersonales = this._formBuilder.group({\n      nombre: [''],\n      fechaNacimiento: [],\n      fotografia: ['']\n    });\n    this.inicioSesion = this._formBuilder.group({\n      email: [''],\n      password: [''],\n      passwordRepetida: ['']\n    }); // Ponemos en los calendarios el lunes como primer día\n\n    date.getFirstDayOfWeek = () => 1;\n  }\n\n  openDialog(err) {\n    const dialogRef = this.dialog.open(DialogComponent, {\n      width: '300px',\n      data: {\n        err: err\n      }\n    });\n    dialogRef.afterClosed().subscribe(result => {});\n  }\n\n  creaUsuario() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      (yield _this.authService.registraUsuario(_this.datosPersonales, _this.inicioSesion)).subscribe(resp => {\n        _this.router.navigateByUrl('auth/login');\n      }, err => {\n        err => {\n          let erroresEnviar = [];\n          let formErrors = err.error.errores === undefined;\n\n          if (!formErrors) {\n            // Errores al checkear si estan vacios email, contraseña y si el email está bien formado\n            Object.entries(err.error.errores).forEach(([key, value]) => {\n              console.log(value);\n              erroresEnviar.push(value);\n            });\n          } else {\n            // Errores del backend: pj usuario o contraseña incorrectos\n            erroresEnviar.push(err.error);\n          }\n\n          _this.openDialog(erroresEnviar);\n        };\n      });\n    })();\n  }\n\n}\n\nRegistroComponent.ɵfac = function RegistroComponent_Factory(t) {\n  return new (t || RegistroComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.DateAdapter), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.Router));\n};\n\nRegistroComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RegistroComponent,\n  selectors: [[\"app-registro\"]],\n  decls: 58,\n  vars: 16,\n  consts: [[1, \"relleno\", 3, \"linear\"], [\"stepper\", \"\"], [3, \"stepControl\"], [3, \"formGroup\"], [\"matStepLabel\", \"\"], [\"autocomplete\", \"off\", \"matInput\", \"\", \"placeholder\", \"Nombre\", \"formControlName\", \"nombre\", \"required\", \"\"], [\"color\", \"accent\", \"appearance\", \"fill\"], [\"matInput\", \"\", \"formControlName\", \"fechaNacimiento\", \"datePickerFormat\", \"DD/MM/YYYY\", \"readonly\", \"\", \"required\", \"\", 3, \"matDatepicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"fechaNacimiento\", \"\"], [\"type\", \"file\", \"name\", \"fotografia\", \"enctype\", \"multipart/form-data\", \"formControlName\", \"fotografia\", \"placeholder\", \"Imagen de perfil (JPG)\", 3, \"accept\"], [\"matSuffix\", \"\", 1, \"carpeta\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matStepperNext\", \"\"], [1, \"inicio_sesion\", 3, \"formGroup\"], [\"matInput\", \"\", \"placeholder\", \"tucorreo@dominio.com\", \"formControlName\", \"email\", \"required\", \"\"], [\"appearance\", \"fill\"], [\"type\", \"password\", \"formControlName\", \"password\", \"matInput\", \"\", \"required\", \"\", 3, \"type\"], [\"type\", \"button\", \"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [\"type\", \"password\", \"formControlName\", \"passwordRepetida\", \"matInput\", \"\", \"required\", \"\", 3, \"type\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matStepperPrevious\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matStepperNext\", \"\", 1, \"boton_derecho\"], [1, \"terminar\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"boton_derecho\", 3, \"click\"]],\n  template: function RegistroComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"mat-vertical-stepper\", 0, 1)(2, \"mat-step\", 2)(3, \"form\", 3);\n      i0.ɵɵtemplate(4, RegistroComponent_ng_template_4_Template, 1, 0, \"ng-template\", 4);\n      i0.ɵɵelementStart(5, \"mat-form-field\");\n      i0.ɵɵelement(6, \"input\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"mat-form-field\", 6)(8, \"mat-label\");\n      i0.ɵɵtext(9, \"Fecha de nacimiento\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"input\", 7);\n      i0.ɵɵelementStart(11, \"mat-hint\");\n      i0.ɵɵtext(12, \"MM/DD/YYYY\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"mat-datepicker-toggle\", 8)(14, \"mat-datepicker\", null, 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"mat-form-field\");\n      i0.ɵɵelement(17, \"ngx-mat-file-input\", 10);\n      i0.ɵɵelementStart(18, \"mat-icon\", 11);\n      i0.ɵɵtext(19, \"folder_shared\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"mat-hint\");\n      i0.ɵɵtext(21, \"Opcional\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\")(23, \"button\", 12);\n      i0.ɵɵtext(24, \" Siguiente \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(25, \"mat-step\", 2)(26, \"form\", 13);\n      i0.ɵɵtemplate(27, RegistroComponent_ng_template_27_Template, 1, 0, \"ng-template\", 4);\n      i0.ɵɵelementStart(28, \"mat-form-field\");\n      i0.ɵɵelement(29, \"input\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"mat-form-field\", 15)(31, \"mat-label\");\n      i0.ɵɵtext(32, \"Introduce tu contrase\\u00F1a\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(33, \"input\", 16);\n      i0.ɵɵelementStart(34, \"button\", 17);\n      i0.ɵɵlistener(\"click\", function RegistroComponent_Template_button_click_34_listener() {\n        return ctx.hide = !ctx.hide;\n      });\n      i0.ɵɵelementStart(35, \"mat-icon\");\n      i0.ɵɵtext(36);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(37, \"mat-form-field\", 15)(38, \"mat-label\");\n      i0.ɵɵtext(39, \"Repite tu contrase\\u00F1a\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(40, \"input\", 18);\n      i0.ɵɵelementStart(41, \"button\", 17);\n      i0.ɵɵlistener(\"click\", function RegistroComponent_Template_button_click_41_listener() {\n        return ctx.hideRepetida = !ctx.hideRepetida;\n      });\n      i0.ɵɵelementStart(42, \"mat-icon\");\n      i0.ɵɵtext(43);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(44, \"div\")(45, \"button\", 19);\n      i0.ɵɵtext(46, \" Atr\\u00E1s \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"button\", 20);\n      i0.ɵɵtext(48, \" Siguiente \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(49, \"mat-step\");\n      i0.ɵɵtemplate(50, RegistroComponent_ng_template_50_Template, 1, 0, \"ng-template\", 4);\n      i0.ɵɵelementStart(51, \"h3\", 21);\n      i0.ɵɵtext(52, \" \\u00A1Has rellenado todos los datos! Pulsa en continuar para registrar tu cuenta. \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(53, \"div\")(54, \"button\", 19);\n      i0.ɵɵtext(55, \" Atr\\u00E1s \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(56, \"button\", 22);\n      i0.ɵɵlistener(\"click\", function RegistroComponent_Template_button_click_56_listener() {\n        return ctx.creaUsuario();\n      });\n      i0.ɵɵtext(57, \" Continuar \");\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      const _r2 = i0.ɵɵreference(15);\n\n      i0.ɵɵproperty(\"linear\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"stepControl\", ctx.datosPersonales);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.datosPersonales);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"matDatepicker\", _r2);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"for\", _r2);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"accept\", \".jpg\");\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"stepControl\", ctx.inicioSesion);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.inicioSesion);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"type\", ctx.hide ? \"password\" : \"text\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hide);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.hide ? \"visibility_off\" : \"visibility\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"type\", ctx.hideRepetida ? \"password\" : \"text\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hideRepetida);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.hideRepetida ? \"visibility_off\" : \"visibility\");\n    }\n  },\n  dependencies: [i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName, i5.MatIcon, i6.MatButton, i7.MatFormField, i7.MatHint, i7.MatLabel, i7.MatSuffix, i8.MatInput, i9.MatStep, i9.MatStepLabel, i9.MatStepper, i9.MatStepperNext, i9.MatStepperPrevious, i10.MatDatepicker, i10.MatDatepickerInput, i10.MatDatepickerToggle, i11.FileInputComponent],\n  styles: [\".example-input-wrapper[_ngcontent-%COMP%] {\\r\\n    margin-bottom: 16px;\\r\\n  }\\r\\n  \\r\\n  label[_ngcontent-%COMP%] {\\r\\n    margin-right: 4px;\\r\\n  }\\r\\n  \\r\\n  .relleno[_ngcontent-%COMP%]{\\r\\n    height: 100%;\\r\\n    width: 100%;\\r\\n  }\\r\\n  \\r\\n  mat-form-field[_ngcontent-%COMP%]{\\r\\n    margin-left: 5%;\\r\\n  }\\r\\n  \\r\\n  .carpeta[_ngcontent-%COMP%]{\\r\\n    transform: scale(1.35);\\r\\n    color:white;\\r\\n  }\\r\\n  \\r\\n  mat-icon[_ngcontent-%COMP%]{\\r\\n    color:white;\\r\\n  }\\r\\n  \\r\\n  input[_ngcontent-%COMP%]{\\r\\n    color:white;\\r\\n  }\\r\\n  \\r\\n  ngx-mat-file-input[_ngcontent-%COMP%]{\\r\\n    color:white;\\r\\n  }\\r\\n  \\r\\n  .boton_derecho[_ngcontent-%COMP%]{\\r\\n    margin-left:10px;\\r\\n  }\\r\\n  \\r\\n  button[_ngcontent-%COMP%]{\\r\\n    margin-top: 5px;\\r\\n  }\\r\\n  \\r\\n  .terminar[_ngcontent-%COMP%]{\\r\\n    color: white;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdHJvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxtQkFBbUI7RUFDckI7O0VBRUE7SUFDRSxpQkFBaUI7RUFDbkI7O0VBRUE7SUFDRSxZQUFZO0lBQ1osV0FBVztFQUNiOztFQUVBO0lBQ0UsZUFBZTtFQUNqQjs7RUFFQTtJQUNFLHNCQUFzQjtJQUN0QixXQUFXO0VBQ2I7O0VBQ0E7SUFDRSxXQUFXO0VBQ2I7O0VBRUE7SUFDRSxXQUFXO0VBQ2I7O0VBQ0E7SUFDRSxXQUFXO0VBQ2I7O0VBRUE7SUFDRSxnQkFBZ0I7RUFDbEI7O0VBRUE7SUFDRSxlQUFlO0VBQ2pCOztFQUVBO0lBQ0UsWUFBWTtFQUNkIiwiZmlsZSI6InJlZ2lzdHJvLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhhbXBsZS1pbnB1dC13cmFwcGVyIHtcclxuICAgIG1hcmdpbi1ib3R0b206IDE2cHg7XHJcbiAgfVxyXG4gIFxyXG4gIGxhYmVsIHtcclxuICAgIG1hcmdpbi1yaWdodDogNHB4O1xyXG4gIH1cclxuXHJcbiAgLnJlbGxlbm97XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICB9XHJcblxyXG4gIG1hdC1mb3JtLWZpZWxke1xyXG4gICAgbWFyZ2luLWxlZnQ6IDUlO1xyXG4gIH1cclxuXHJcbiAgLmNhcnBldGF7XHJcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMzUpO1xyXG4gICAgY29sb3I6d2hpdGU7XHJcbiAgfVxyXG4gIG1hdC1pY29ue1xyXG4gICAgY29sb3I6d2hpdGU7XHJcbiAgfVxyXG5cclxuICBpbnB1dHtcclxuICAgIGNvbG9yOndoaXRlO1xyXG4gIH1cclxuICBuZ3gtbWF0LWZpbGUtaW5wdXR7XHJcbiAgICBjb2xvcjp3aGl0ZTtcclxuICB9XHJcblxyXG4gIC5ib3Rvbl9kZXJlY2hve1xyXG4gICAgbWFyZ2luLWxlZnQ6MTBweDtcclxuICB9XHJcblxyXG4gIGJ1dHRvbntcclxuICAgIG1hcmdpbi10b3A6IDVweDtcclxuICB9XHJcblxyXG4gIC50ZXJtaW5hcntcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICB9XHJcbiJdfQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","RegistroComponent","constructor","_formBuilder","date","authService","router","group","nombre","fechaNacimiento","fotografia","email","password","passwordRepetida","getFirstDayOfWeek","openDialog","err","dialogRef","dialog","open","DialogComponent","width","data","afterClosed","subscribe","result","creaUsuario","registraUsuario","datosPersonales","inicioSesion","resp","navigateByUrl","erroresEnviar","formErrors","error","errores","undefined","Object","entries","forEach","key","value","console","log","push","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\victo\\OneDrive\\Escritorio\\TFG\\TFG-Código\\Frontend\\src\\app\\auth\\pages\\registro\\registro.component.html","C:\\Users\\victo\\OneDrive\\Escritorio\\TFG\\TFG-Código\\Frontend\\src\\app\\auth\\pages\\registro\\registro.component.ts"],"sourcesContent":["<mat-vertical-stepper [linear]=\"false\" #stepper class=\"relleno\">\n  <mat-step [stepControl]=\"datosPersonales\">\n    <form [formGroup]=\"datosPersonales\">\n      <ng-template matStepLabel>Datos personales</ng-template>\n      <mat-form-field>\n        <input\n          autocomplete=\"off\"\n          matInput\n          placeholder=\"Nombre\"\n          formControlName=\"nombre\"\n          required\n        />\n      </mat-form-field>\n      <mat-form-field color=\"accent\" appearance=\"fill\">\n        <mat-label>Fecha de nacimiento</mat-label>\n        <input\n          matInput\n          [matDatepicker]=\"fechaNacimiento\"\n          formControlName=\"fechaNacimiento\"\n          datePickerFormat=\"DD/MM/YYYY\"\n          readonly\n          required\n        />\n        <mat-hint>MM/DD/YYYY</mat-hint>\n        <mat-datepicker-toggle\n          matSuffix\n          [for]=\"fechaNacimiento\"\n        ></mat-datepicker-toggle>\n        <mat-datepicker #fechaNacimiento></mat-datepicker>\n      </mat-form-field>\n      <mat-form-field>\n        <ngx-mat-file-input\n          type=\"file\"\n          name=\"fotografia\"\n          enctype=\"multipart/form-data\"\n          formControlName=\"fotografia\"\n          placeholder=\"Imagen de perfil (JPG)\"\n          [accept]=\"'.jpg'\"\n        ></ngx-mat-file-input>\n        <mat-icon matSuffix class=\"carpeta\">folder_shared</mat-icon>\n        <mat-hint>Opcional</mat-hint>\n      </mat-form-field>\n\n      <div>\n        <button mat-raised-button color=\"primary\" matStepperNext>\n          Siguiente\n        </button>\n      </div>\n    </form>\n  </mat-step>\n  <mat-step [stepControl]=\"inicioSesion\">\n    <form [formGroup]=\"inicioSesion\" class=\"inicio_sesion\">\n      <ng-template matStepLabel>Configuración de inicio de sesión</ng-template>\n      <mat-form-field>\n        <input\n          matInput\n          placeholder=\"tucorreo@dominio.com\"\n          formControlName=\"email\"\n          required\n        />\n      </mat-form-field>\n      <mat-form-field appearance=\"fill\">\n        <mat-label>Introduce tu contraseña</mat-label>\n        <input\n          type=\"password\"\n          formControlName=\"password\"\n          matInput\n          [type]=\"hide ? 'password' : 'text'\"\n          required=\"\"\n        />\n        <button\n          type=\"button\"\n          mat-icon-button\n          matSuffix\n          (click)=\"hide = !hide\"\n          [attr.aria-label]=\"'Hide password'\"\n          [attr.aria-pressed]=\"hide\"\n        >\n          <mat-icon>{{ hide ? \"visibility_off\" : \"visibility\" }}</mat-icon>\n        </button>\n      </mat-form-field>\n      <mat-form-field appearance=\"fill\">\n        <mat-label>Repite tu contraseña</mat-label>\n        <input\n          type=\"password\"\n          formControlName=\"passwordRepetida\"\n          matInput\n          [type]=\"hideRepetida ? 'password' : 'text'\"\n          required=\"\"\n        />\n        <button\n          type=\"button\"\n          mat-icon-button\n          matSuffix\n          (click)=\"hideRepetida = !hideRepetida\"\n          [attr.aria-label]=\"'Hide password'\"\n          [attr.aria-pressed]=\"hideRepetida\"\n        >\n          <mat-icon>{{\n            hideRepetida ? \"visibility_off\" : \"visibility\"\n          }}</mat-icon>\n        </button>\n      </mat-form-field>\n      <div>\n        <button mat-raised-button color=\"primary\" matStepperPrevious>\n          Atrás\n        </button>\n        <button\n          mat-raised-button\n          color=\"primary\"\n          matStepperNext\n          class=\"boton_derecho\"\n        >\n          Siguiente\n        </button>\n      </div>\n    </form>\n  </mat-step>\n  <mat-step>\n    <ng-template matStepLabel>Terminar</ng-template>\n    <h3 class=\"terminar\">\n      ¡Has rellenado todos los datos! Pulsa en continuar para registrar tu\n      cuenta.\n    </h3>\n    <div>\n      <button mat-raised-button color=\"primary\" matStepperPrevious>\n        Atrás\n      </button>\n      <button\n        mat-raised-button\n        color=\"primary\"\n        (click)=\"creaUsuario()\"\n        class=\"boton_derecho\"\n      >\n        Continuar\n      </button>\n    </div>\n  </mat-step>\n</mat-vertical-stepper>\n","import { Component } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { DateAdapter } from '@angular/material/core';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../../services/auth.service';\n\n@Component({\n  selector: 'app-registro',\n  templateUrl: './registro.component.html',\n  styleUrls: ['./registro.component.css'],\n})\nexport class RegistroComponent {\n  hide: boolean = true;\n  hideRepetida: boolean = true;\n  constructor(\n    private _formBuilder: FormBuilder,\n    private date: DateAdapter<Date>,\n    private authService: AuthService,\n    private router: Router\n  ) {\n    // Ponemos en los calendarios el lunes como primer día\n    date.getFirstDayOfWeek = () => 1;\n  }\n  datosPersonales: FormGroup = this._formBuilder.group({\n    nombre: [''],\n    fechaNacimiento: [],\n    fotografia: [''],\n  });\n\n  inicioSesion: FormGroup = this._formBuilder.group({\n    email: [''],\n    password: [''],\n    passwordRepetida: [''],\n  });\n\n  openDialog(err: any): void {\n    const dialogRef = this.dialog.open(DialogComponent, {\n      width: '300px',\n      data: { err: err },\n    });\n\n    dialogRef.afterClosed().subscribe((result) => {});\n  }\n\n  async creaUsuario() {\n    (\n      await this.authService.registraUsuario(\n        this.datosPersonales,\n        this.inicioSesion\n      )\n    ).subscribe(\n      (resp) => {\n        this.router.navigateByUrl('auth/login');\n      },\n      (err) => {\n        (err) => {\n          let erroresEnviar: any = [];\n          let formErrors = err.error.errores === undefined;\n          if (!formErrors) {\n            // Errores al checkear si estan vacios email, contraseña y si el email está bien formado\n            Object.entries(err.error.errores).forEach(([key, value]) => {\n              console.log(value);\n              erroresEnviar.push(value);\n            });\n          } else {\n            // Errores del backend: pj usuario o contraseña incorrectos\n            erroresEnviar.push(err.error);\n          }\n          this.openDialog(erroresEnviar);\n        };\n      }\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}